# Kubernetes

Kubernetes is an open-source container orchestration tool.

## Benefits
- **No Downtime**
- **Scalability**
- **Disaster Recovery**

## Kubernetes Components

### Pod
- Offers abstraction over containers.
- 1 application per pod.
- Smallest unit of Kubernetes.

### Service
- Provides a permanent IP address attached to each pod.

### Ingress
- Manages external access to services within a cluster.
- Provides a set of rules that allow incoming connections to reach the appropriate services.

### ConfigMap
- Stores configuration data like URLs or other services.

### Secret
- Similar to ConfigMap, used to store secret data in base64 encoded format.

### Volumes
- Attaches physical storage on a hard drive (e.g., storage on a local machine).

### Replication
- Replicate everything on multiple servers (Node 1 and Node 2).
- To create a replica, define a blueprint for the pod (specify how many pods you want).

### Deployments
- An abstraction on top of pods.

### Stateful Applications
- Specifically for applications like databases.

### Deployment Types
- **Stateless**: For applications that do not maintain state.
- **Stateful**: For databases.

## Kubernetes Architecture

### Node Components
Three processes must be installed on every node:
- **Container Runtime**
- **Kubelet**: Interacts with the container runtime and node.
- **Kube Proxy**: Forwards requests.

### Master Node
Manages processes and has four components:
- **API Server**: Acts as a cluster gateway; good for security because there is only one entry point into the cluster.
- **Scheduler**: Determines where to place the pod (e.g., on the least used node).
- **Controller Manager**: Detects cluster state changes.
- **etcd**: The cluster brain; all changes get updated in the key-value store (the actual application data is not stored in etcd).

## Minikube
- Creates a virtual box on your laptop.
- 1-node Kubernetes clusters.

### kubectl
- Command line tool for Minikube.

### Deployment
- Has the blueprints for creating a pod.
- In practice, you will rarely create the ReplicaSet directly.

## Layers of Abstraction
- **Deployment** manages a
- **ReplicaSet** which manages a
- **Pod** which is an abstraction of 
- **A Container**.

## Kubernetes YAML Structure
Three parts:
1. **Metadata** for the component.
2. **Service**
3. **Status**: Automatically generated by Kubernetes.

### Commands
- Use `kubectl apply` and `kubectl delete` to work with deployments.
- The container port from the deployment YAML and the target port from the service must match.

### ConfigMap and Secret Structure
Similar structure:
- **Kind**
- **Metadata**
- **Data**

## Kubernetes Namespaces
- A namespace is a cluster inside a cluster.

### Default Namespaces
1. **kube-system**: Do not modify.
2. **kube-public**
3. **kube-node-lease**

### Why Use Namespaces
- Used to group resources (e.g., databases, monitoring namespaces).

### Cases to Use Namespaces
1. Structure your components.
2. Avoid conflicts between teams.
3. Share services between different environments.
4. Set access and resource limits at the namespace level.

gcloud container clusters get-credentials my-gke-cluster --zone europe-west1-b --project tennis-registration
gke_tennis-registration_europe-west1-b_my-gke-cluster

𝐤𝐮𝐛𝐞-𝐚𝐩𝐢-𝐬𝐞𝐫𝐯𝐞𝐫: Handles API calls efficiently, scaling as needed. It's the gateway for interacting with Kubernetes, and processing commands and requests.  

𝐞𝐭𝐜𝐝: Stores important cluster data securely. Only the API server can directly access etcd, ensuring data integrity and consistency.  

𝐤𝐮𝐛𝐞-𝐬𝐜𝐡𝐞𝐝𝐮𝐥𝐞𝐫: Finds the best nodes for tasks based on resource availability and requirements. It's like a matchmaker, pairing workloads with suitable nodes.  

𝐜𝐨𝐧𝐭𝐫𝐨𝐥𝐥𝐞𝐫-𝐦𝐚𝐧𝐚𝐠𝐞𝐫: Keeps things running smoothly by monitoring for changes and taking necessary actions. It handles tasks like cleaning up unused resources and managing namespaces.  

𝐂𝐥𝐨𝐮𝐝 𝐂𝐨𝐧𝐭𝐫𝐨𝐥𝐥𝐞𝐫 𝐌𝐚𝐧𝐚𝐠𝐞𝐫: Connects your cluster to the cloud provider's features. It handles nodes, routes, and services, letting cloud features integrate smoothly with Kubernetes.  

𝐤𝐮𝐛𝐞𝐥𝐞𝐭: Ensures containers are healthy and manages node resources. It's like a caretaker, making sure containers are running well on their assigned nodes.  

𝐤𝐮𝐛𝐞-𝐩𝐫𝐨𝐱𝐲: Manages network configuration on nodes, facilitating communication between services and pods. It's like a traffic cop, directing network traffic within the cluster.  

𝐂𝐨𝐧𝐭𝐚𝐢𝐧𝐞𝐫 𝐑𝐮𝐧𝐭𝐢𝐦𝐞: Manages containers and images, enabling them to work seamlessly on Kubernetes. It's the bridge between Kubernetes and container runtimes like Docker.  

𝐏𝐨𝐝𝐬: Bundles of processes that run until they finish their tasks. They're like temporary work crews, executing specific jobs within the cluster.  